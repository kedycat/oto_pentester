from colorama import Fore, Back, Style
import time
import os

def bosluk_kacis_silme(yazılım, komut):
    i = 0
    while True:

        if komut[i] == " ":
            regular = komut[i:].replace(" ", "_")
            dirbregular = regular.replace("/","")
            os.system(komut + ">> report/"+yazılım.upper()+dirbregular+".txt")
            print(">>>>>Tarama sonucunuz report/ klasörüne "+yazılım.upper()+dirbregular+ ".txt şeklinde kaydedilmiştir.\n")
            break;
        else:
            i = i + 1

def cge():
    print(Fore.BLUE)
    os.system("figlet CISCO-GLOBAL-EXPLOITER")
    print(Fore.RESET)
    while True:
        os.system("cge")
        target = input(str("Hedef ip'yi giriniz(Çıkmak için 'g' giriniz): "))
        if target == 'q':
            time.sleep(0.3)
            break
        else:
            vuln_number = input(str("Listeden hedef zafiyet numarasını giriniz: "))
            try:
                os.system("cge "+target+" "+vuln_number)
            except:
                print(">>>>>Geçersiz girdi")

def exploit_suggester():

    print(Fore.BLUE)
    os.system("figlet CISCO-GLOBAL-EXPLOITER")
    print(Fore.RESET)
    os.system("tree /opt/linux-exploit-suggester")
    print(""">>>>>Kullanmak için linux-exploit-suggester.sh dosyasını hedef sisteme yükleyip çalıştırın.""")
    time.sleep(1)

def msfconsole():
    os.system("msfconsole")

def rsf():
    os.system("python3 /opt/routersploit/rsf.py")

def setoolkit():
    os.system("sudo setoolkit")

def sqlmap():
    print(Fore.YELLOW)
    os.system("figlet SQLMAP")
    print(Fore.RESET)
    while True:
        sqlmap_komut = input(str("Komutu giriniz (Önceki adıma dönmek için 'g' ya da '1' basınız): "))
        print("\n")
        yazılım = "sqlmap"
        try:
            if sqlmap_komut == '1' or sqlmap_komut == 'g':
                time.sleep(0.5)
                print("\n")
                break;
            elif sqlmap_komut == "sqlmap -h" or sqlmap_komut == "sqlmap -hh":
                os.system(sqlmap_komut)
            else:
                os.system(sqlmap_komut)
                print("\n")
                bosluk_kacis_silme(yazılım,sqlmap_komut)
        except:
            print(">>>>> Geçersiz Girdi!!!")

def exploitaton():

    while True:
        print(Fore.BLUE)
        os.system("figlet SOMURME")
        print(Fore.RESET)

        secim = input(str("""Exploitation(Sömürme) adımını seçtiniz.
        Kullanabileceğiniz araçlar:
        
    1) Cısco-global-exploiter
    2) linux-exploit-suggester
    3) Metasploit-framework
    4) Router Sploit
    5) Social Engineering Toolkit
    6) Sqlmap
    7) Önceki adıma dönmek için 'g ya da 7' basınız.

    Kullanmak istediğiniz araç: """))
        print("\n")
        time.sleep(0.2)
        #cge
        if (secim == '1'):
            time.sleep(0.2)
            cge()
        #exploit_suggester
        elif (secim == '2'):
            time.sleep(0.2)
            exploit_suggester()
        elif (secim == '3'):
            time.sleep(0.2)
            msfconsole()
        elif (secim == '4'):
            time.sleep(0.2)
            rsf()
        elif (secim == '5'):
            time.sleep(0.2)
            setoolkit()
        elif (secim == '6'):
            time.sleep(0.2)
            sqlmap()
        elif (secim == 'g' or secim == '7'):
            time.sleep(0.2)
            break;
        else:
            print(">>>>>Geçersiz girdi!!!")
            print("\n")
            time.sleep(0.5)
exploitaton()