from colorama import Fore, Back, Style
import time
import os

def strings():
    print(Fore.RED)
    os.system("figlet STRINGS")
    print(Fore.RESET)

    yazılım = "strings"

    while True:
        print("""
        1) Medya dosyasının içinde gizlenenleri görmek için 1 giriniz.
        2) Çıkmak için 'g' ya da '2' giriniz""")

        strings_secim = input(str("Seçiminizi giriniz."))

        if strings_secim == '1':
            dosya_ismi = input(str("Hedef dosyanın ismini giriniz (kaydetmek için): "))
            print("\n")
            dosya_yolu = input(str("Dosyayı yoluyla birlikte giriniz (Orn: /home/kedycat/Pictures/image.jpg): "))
            print("\n")
            os.system("sudo strings "+ dosya_yolu +" | tee report/"+yazılım.upper()+dosya_ismi+".txt")
            print("Çıktı report/ klasörü içine "+yazılım.upper()+dosya_ismi+".txt şeklinde kaydedilmiştir.")


        elif strings_secim == '2':

            time.sleep(0.5)
            print("\n")
            break;
        else:
            print("Geçersiz girdi!!!")
            print("\n")

def binwalk():
    print(Fore.RED)
    os.system("figlet BINWALK")
    print(Fore.RESET)

    yazılım = "binwalk"

    while True:
        print("""
        1) Binwalk hakkında bilgi almak 1 giriniz
        2) Medya dosyasının içinde gizlenenleri görmek için 2 giriniz
        3) Özel komut çalıştırmak için 3 girini 
        4) Çıkmak için 'g' ya da '4' giriniz""")

        binwalk_secim = input(str("Seçiminizi giriniz."))

        if binwalk_secim == '1':
            os.system(yazılım)

        elif binwalk_secim == '2':

            dosya_ismi = input(str("Hedef dosyanın ismini giriniz (kayıt için): "))
            print("\n")
            dosya_yolu = input(str("Dosyayı yoluyla birlikte giriniz (Orn: /home/kedycat/Pictures/image.jpg): "))
            print("\n")
            os.system("sudo binwalk "+ dosya_yolu +" | tee report/"+yazılım.upper()+dosya_ismi+".txt")
            print("\n")
            extract = input(str("Dosya içindekileri çıkartmak ister misiniz ? (y/n)"))
            if extract == 'y':
                os.system("sudo binwalk -e "+ dosya_yolu+" -C report/")
            elif extract == 'n':
                print("Medyanın içindekiler çıkartılmadı")
                print("\n")

        elif binwalk_secim == '3':
            komut = input(str("Kullanmak istediğiniz komutu girin: "))
            os.system(komut)


        elif binwalk_secim == 'q' or binwalk_secim == '4':
            time.sleep(0.5)
            print("\n")
            break;
        else:
            print("Geçersiz girdi!!!")
            print("\n")


def exiftool():

    print(Fore.RED)
    os.system("figlet EXIFTOOL")
    print(Fore.RESET)

    yazılım = "exiftool"
    while True:
        dosya_isim = input(str("Dosyanın ismini giriniz (kaydetmek için, çıkmak için 'q' giriniz): "))
        if dosya_isim == 'q':
            time.sleep(0.5)
            print("\n")
            break;
        else:
            exif_dosya = input(str("Hakkında bilgi almak istediğiniz medya dosyasını yoluyla birlikte giriniz Orn:(/home/user/pictures/medya.jpg, çıkmak için 'q' giriniz): "))
        if exif_dosya == 'q':
            time.sleep(0.5)
            print("\n")
            break;
        else:
            os.system("sudo exiftool "+exif_dosya+" | tee report/"+yazılım.upper()+dosya_isim+".txt")



def stenog():
    while True:
        print(Fore.RED)
        os.system("figlet STENOGRAPHY")
        print(Fore.RESET)

        secim = input(str("""Stenography adımını seçtiniz. Kullanabileceğiniz araçlar:

        1) Exiftool
        2) Binwalk
        3) Strings
        4) Önceki adıma dönmek için 'g ya da 4' basınız.

    Kullanmak istediğinzi aracı seçiniz: """))
        print("\n")
        time.sleep(0.2)
        if (secim == '1'):
            #exiftool
            time.sleep(0.2)
            exiftool()
        elif (secim == '2'):
            #binwalk
            time.sleep(0.2)
            binwalk()
        elif (secim == '3'):
            #strings
            time.sleep(0.2)
            strings()
        elif (secim == 'g' or secim == '4'):
            time.sleep(0.2)
            break;
        else:
            print(">>>>>Geçersiz girdi!!!")
            print("\n")
            time.sleep(0.5)

stenog()